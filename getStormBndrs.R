## Start at rising limb (d1,q1)
## Get next peak (dp,qp)
## get next rising limb (d2,q2)
## if q2 <= q1, keep
## if not, got to next

